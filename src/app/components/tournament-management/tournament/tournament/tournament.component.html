<form [formGroup]="validationForm">
	<mat-tab-group [selectedIndex]="4">
		<mat-tab label="General">
			<div class="container-fluid">
				<div class="row">
					<div class="col">
						<h3>Tournament name</h3>

						<mat-form-field class="full-width">
							<mat-label>Tournament name</mat-label>
							<input matInput formControlName="tournament-name" />

							<mat-error *ngIf="validationForm.get('tournament-name').errors && (validationForm.get('tournament-name').touched || validationForm.get('tournament-name').dirty)">
								This field is required
							</mat-error>
						</mat-form-field>

						<p>The name of the tournament</p>
					</div>

					<div class="col">
						<h3>Tournament acronym</h3>

						<mat-form-field class="full-width">
							<mat-label>Tournament acronym</mat-label>
							<input matInput formControlName="tournament-acronym" />

							<mat-error *ngIf="validationForm.get('tournament-acronym').errors && (validationForm.get('tournament-acronym').touched || validationForm.get('tournament-acronym').dirty)">
								This field is required
							</mat-error>
						</mat-form-field>

						<p>The acronym of the tournament</p>
					</div>

					<div class="col">
						<h3>Gamemode</h3>

						<mat-form-field class="full-width">
							<mat-label>Gamemode</mat-label>
							<mat-select formControlName="tournament-gamemode">
								<mat-option [value]="0">osu!</mat-option>
								<mat-option [value]="1">osu!taiko</mat-option>
								<mat-option [value]="2">osu!catch</mat-option>
								<mat-option [value]="3">osu!mania</mat-option>
							</mat-select>

							<mat-error *ngIf="validationForm.get('tournament-gamemode').errors && (validationForm.get('tournament-gamemode').touched || validationForm.get('tournament-gamemode').dirty)">
								This field is required
							</mat-error>
						</mat-form-field>

						<p>The gamemode that will be used for all the beatmaps when picking</p>
					</div>
				</div>

				<div class="row">
					<div class="col">
						<h3>Score system</h3>

						<mat-form-field class="full-width">
							<mat-label>Score system</mat-label>
							<mat-select formControlName="tournament-score-system" (selectionChange)="changeScoreInterface($event)">
								<mat-option *ngFor="let scoreInterface of this.calculateScoreInterfaces.getAllScoreInterfaces()" [value]="scoreInterface.getIdentifier()">{{ scoreInterface.getIdentifier() }}</mat-option>
							</mat-select>

							<mat-error *ngIf="validationForm.get('tournament-score-system').errors && (validationForm.get('tournament-score-system').touched || validationForm.get('tournament-score-system').dirty)">
								This field is required
							</mat-error>
						</mat-form-field>

						<p>Select the score system that is being used for the multiplayer game.</p>

						<div class="alert alert-info" *ngIf="this.tournament.scoreInterface">
							{{ this.tournament.scoreInterface.getDescription() }}
						</div>
					</div>

					<div class="col" *ngIf="this.tournament.scoreInterface && this.tournament.scoreInterface.isSoloTournament() == null">
						<h3>Tournament format</h3>

						<mat-form-field class="full-width">
							<mat-label>Tournament format</mat-label>
							<mat-select formControlName="tournament-format">
								<mat-option value="solo">Solo</mat-option>
								<mat-option value="teams">Teams</mat-option>
							</mat-select>

							<mat-error *ngIf="validationForm.get('tournament-format').errors && (validationForm.get('tournament-format').touched || validationForm.get('tournament-format').dirty)">
								This field is required
							</mat-error>
						</mat-form-field>

						<p>The tournament format, teams or solo</p>
					</div>

					<div class="col" *ngIf="this.tournament.scoreInterface && this.tournament.scoreInterface.getTeamSize() == null && !tournament.isSoloTournament()">
						<h2>Team size</h2>

						<mat-form-field class="full-width">
							<mat-label>Team size</mat-label>
							<input matInput formControlName="tournament-team-size" />

							<mat-error *ngIf="validationForm.get('tournament-team-size').errors && validationForm.get('tournament-team-size').errors.required && (validationForm.get('tournament-team-size').touched || validationForm.get('tournament-team-size').dirty)">
								This field is required
							</mat-error>

							<mat-error *ngIf="validationForm.get('tournament-team-size').errors && validationForm.get('tournament-team-size').errors.min && (validationForm.get('tournament-team-size').touched || validationForm.get('tournament-team-size').dirty)">
								The minimum team size is 1
							</mat-error>

							<mat-error *ngIf="validationForm.get('tournament-team-size').errors && validationForm.get('tournament-team-size').errors.max && (validationForm.get('tournament-team-size').touched || validationForm.get('tournament-team-size').dirty)">
								The maximum team size is 8
							</mat-error>
						</mat-form-field>

						<p>
							Enter the amount of players that are allowed to play in a team.
						</p>
					</div>
				</div>
			</div>
		</mat-tab>

		<mat-tab label="Access">
			<div class="container-fluid">
				<h3>Administrator</h3>
				<p>Manage the users that you want to give full permission to. They will be able to change data, which will then trigger an update for all the users that have imported the tournament.</p>
				<button mat-raised-button color="accent" (click)="addUserAsAdministrator()"><fa-icon [icon]="['fas', 'plus']"></fa-icon> add new administrator</button>

				<div class="all-users">
					<div class="user" *ngFor="let administrator of tournament.administrators">
						<a class="link" (click)="electronService.openLink(administrator.getOsuProfileUrl())">{{ administrator.username }}</a>

						<button mat-mini-fab color="warn" (click)="removeAdministrator(administrator)"><fa-icon [icon]="['fas', 'times']"></fa-icon></button>
					</div>
				</div>

				<hr />

				<h3>Tournament access</h3>
				<p>Manage the users that you want to have access to the tournament. They will be able to import the tournament and mappools so they have access to all the data.</p>
				<button mat-raised-button color="accent" (click)="addNewUser()"><fa-icon [icon]="['fas', 'plus']"></fa-icon> add new user</button>

				<div class="all-users">
					<div class="user" *ngFor="let user of tournament.availableTo">
						<a class="link" (click)="electronService.openLink(user.getOsuProfileUrl())">{{ user.username }}</a>

						<button mat-mini-fab color="warn" (click)="removeUser(user)"><fa-icon [icon]="['fas', 'times']"></fa-icon></button>
					</div>
				</div>
			</div>
		</mat-tab>

		<mat-tab label="Webhook">
			<div class="container-fluid">
				<h3>What is a webhook?</h3>
				<p>To put it simple, a webhook is a link to a channel where this client sends a message to. The messages being send currently to that channel are:</p>

				<ul>
					<li>When a referee bans a map for either team</li>
					<li>When a map finishes</li>
					<li>When the referee sends the final result</li>
				</ul>

				<h3>How to create a Discord webhook</h3>
				<i>NOTE: this step is only required when there is no webhook available.</i>
				<ul>
					<li>Go to the server you want the messages to be send to</li>
					<li>Right click on the channel you want the messages to be send to</li>
					<li>Click on "Edit Channel"</li>
					<li>Click on "Integrations"</li>
					<li>Click on "Create Webhook"</li>
					<li>Fill in the fields and finally copy the "Webhook url"</li>
				</ul>

				<div class="row">
					<div class="col">
						<h3>Webhook</h3>

						<mat-form-field class="full-width">
							<mat-label>Webhook</mat-label>
							<input matInput formControlName="webhook" />

							<mat-error *ngIf="validationForm.get('webhook').errors && (validationForm.get('webhook').touched || validationForm.get('webhook').dirty)">
								This field is required
							</mat-error>
						</mat-form-field>

						<p>The webhook where all the messages will be send to</p>
					</div>

					<div class="col">
						<h3>Test webhook</h3>

						<mat-form-field class="full-width">
							<mat-label>Test webhook</mat-label>
							<input matInput formControlName="test-webhook" />

							<mat-error *ngIf="validationForm.get('test-webhook').errors && (validationForm.get('test-webhook').touched || validationForm.get('test-webhook').dirty)">
								This field is required
							</mat-error>
						</mat-form-field>

						<p>The webhook that can be used to test around with (for example a staff-only channel)</p>
					</div>
				</div>
			</div>
		</mat-tab>

		<mat-tab label="Mappool">
			<div class="container-fluid">
				<button mat-raised-button color="accent" (click)="createNewMappool()"><fa-icon [icon]="['fas', 'plus']"></fa-icon> create new mappool</button>

				<div class="mappool-spacing" *ngIf="tournament.mappools.length > 0"></div>

				<div class="alert alert-warning" *ngIf="tournament.mappools.length == 0">
					There are no mappools yet.
				</div>

				<mat-accordion class="mappools" *ngIf="tournament.mappools.length > 0">
					<mat-expansion-panel *ngFor="let mappool of tournament.mappools">
						<mat-expansion-panel-header>
							<mat-panel-title>
								{{ mappool.name }}
							</mat-panel-title>
						</mat-expansion-panel-header>

						content?
					</mat-expansion-panel>
				</mat-accordion>

				<div class="mappool-spacing" *ngIf="tournament.mappools.length > 0"></div>
			</div>
		</mat-tab>
	</mat-tab-group>
</form>
